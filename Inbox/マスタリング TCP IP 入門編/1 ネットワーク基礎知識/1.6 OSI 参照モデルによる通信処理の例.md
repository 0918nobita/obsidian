#技術
ネットワークに接続されたコンピュータのことを、OSI では「ノード」と呼び、TCP/IP では「ホスト」と呼ぶ

各階層では、上位層から渡されたデータに「自分の階層のプロトコル処理に必要な情報」をヘッダとして付ける

受信側では、受信したデータを処理して「ヘッダ」と「上位層へのデータ」に分離することで、元のデータに復元される
## アプリケーション層
メールを送信するシーンでは、メールソフトにおいて「文章を入力した後にデータを送信する部分」がアプリケーション層に相当し、送信ボタンをクリックしたときにアプリケーションプロトコルの処理が始まる

アプリケーション固有のエラー処理も、アプリケーション層の役割と言える
## プレゼンテーション層
送信側：「コンピュータ固有の表現形式」から「ネットワーク全体で共通の形式」に変換する
受信側：「コンピュータ固有の表現形式」に変換する

決めれられた符号化方式によって「ネットワーク全体で共通の形式」に変換する
符号化に失敗すると文字化けが発生する

プレゼンテーション層間でデータの符号化形式を識別するためのヘッダが付与される

実際にデータを転送する処理はセッション層以下に任せる
## セッション層
ホスト双方のセッション層間で、どのようにデータを送れば効率よくやり取りできるかの計画が行われる

複数のメールを送信する場合、
- １つのメールを送信するごとにコネクション (通信経路) を確立し直す
- １つのコネクションを利用してすべてのメールを順番に送信する
- メールの個数分コネクションを確立し、並行して送信する

といった方法が考えられ、これを判断・制御するのがセッション層の役割 (実際にデータを転送する機能はなく、トランスポート層以下に任せる)

セッション層では「どのような手順でデータを伝えるか」が示されたタグ・ヘッダが付与される
## トランスポート層
トランスポート層から下が、実際にネットワークを使ってデータの送信処理を行う縁の下の力持ち的な存在と言える

相手ホストへの通信路を確保し、データ送信の準備をする (コネクションの確立)
このとき得られた通信路で、相手ホストのメール処理プログラムまでデータを届けることが可能になる
通信が終わったら、確立したコネクションを切断する必要もある

通信するコンピュータ間で、確実にデータを届けるために
- データが適切にとどいたかどうかの確認
- 届かなかったデータの再送

をする

コネクションの確立や切断を行い、ホスト間の論理的な通信手段を作り、データ転送の信頼性を保証するのがトランスポート層の役割

送り出すデータを識別するための印などの情報をヘッダに書き込む

実際にデータを相手まで届ける処理はネットワーク層以下に任せる
## ネットワーク層
送信ホストから受信ホストまでにデータを伝達する役割

間に様々なデータリンクがあったとしても、最終目的地までの通信を実現する (エンドツーエンド)

実際にデータを送信するには宛先のアドレスが必要であり、通信を行う全世界のネットワークで一意に決まる番号が使われる

アドレスと、ネットワーク層のパケット配送処理によって、地球の裏側までパケットを送ることが可能になる

アドレス情報などを付与してデータリンク層に渡す
### トランスポート層とネットワーク層の関係
ネットワークアーキテクチャによっては、ネットワーク層でデータの到達性を保証しない場合がある

例えば **TCP/IP のネットワーク層に相当する IP では、データが相手のホストに届けられるという保証はない**
- 途中でデータが消失する
- 順番が入れ替わる
- ２つ以上に増える

可能性があるため

このような信頼性のないネットワーク層の場合、正しくデータを届ける処理はトランスポート層に任されている
## データリンク層、物理層
通信は物理的な通信媒体を使って行われる

データリンク層は、通信媒体で直接接続された機器同士でデータのやり取りを可能にするという役割をもつ

物理層では、データの 0 / 1 を電圧や光のパルスに変換して物理的な通信媒体に流し込む

直接接続された機器間でも識別のためにアドレスが利用されることがあり、このアドレスを
- MAC (Media Access Control) アドレス
- 物理アドレス
- ハードウェアアドレス

などと呼ぶ

この MAC アドレスの情報を含むヘッダが、ネットワーク層から渡されたデータに付けられたうえで実際にネットワークに流される

ネットワーク層もデータリンク層も、アドレスに基づいて宛先までデータを届けるという点では同じだが、ネットワーク層は最終目的地までのデータ配達を担うのに対し、データリンク層は１区間のデータ配達を担う
## 受け取りホスト側の処理
逆の動作をして上位層にデータを渡していく

各層の役割を担うプロトコルとして、ヘッダなどのデータフォーマットと、ヘッダとデータを処理する手順が具体的に定義されている
